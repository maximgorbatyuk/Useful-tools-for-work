# .NET Code Analyzer

A bash script that analyzes .NET/C# codebases to count meaningful lines of code, filtering out boilerplate and non-logic lines. Generated by Claude 4.5 Opus.

## Overview

This tool helps developers understand the actual complexity of their .NET projects by distinguishing between meaningful code and boilerplate. It recursively scans directories containing .NET repositories and provides detailed metrics per project and in aggregate.

## Features

- **Interactive folder selector** - Choose which directory to analyze
- **Per-project breakdown** - See metrics grouped by each `.csproj` file
- **Smart line filtering** - Identifies and counts only meaningful code
- **NuGet dependency counting** - Tracks total package references
- **Cross-platform compatible** - Works with bash 3.x+ (macOS, Linux)

## What Counts as "Meaningful Code"

The analyzer excludes the following from the meaningful code count:

| Excluded | Examples |
|----------|----------|
| Empty lines | Blank lines |
| Braces only | `{`, `}`, `};` |
| Using statements | `using System;` |
| Namespace declarations | `namespace MyApp` |
| Single-line comments | `// comment` |
| XML documentation | `/// <summary>` |
| Multi-line comments | `/* ... */` |
| LINQ method chains | `.Where(...)`, `.Select(...)` on new lines |
| Wrapped strings | String continuations with `+` |
| Attributes | `[HttpGet]`, `[Authorize]` |
| Preprocessor directives | `#region`, `#if`, `#pragma`, etc. |
| Auto-property accessors | `get;`, `set;`, `init;` |

## Output Metrics

The script provides:

| Metric | Description |
|--------|-------------|
| **Project files** | Count of `*.csproj` files found |
| **C# source files** | Count of `*.cs` files found |
| **NuGet dependencies** | Total `<PackageReference>` entries across all projects |
| **Non-empty lines** | Total lines excluding blank lines |
| **Meaningful code lines** | Lines containing actual logic |
| **Code efficiency ratio** | Percentage of meaningful lines vs total non-empty |

### Per-Project Breakdown

Each project displays:
- Project name
- Number of `.cs` files
- NuGet package count
- Non-empty line count
- Meaningful line count
- Efficiency ratio

Projects are sorted by meaningful code lines (descending).

## Installation

1. Download the script:
```bash
curl -O https://path-to-script/analyze-dotnet.sh
```

2. Make it executable:
```bash
chmod +x analyze-dotnet.sh
```

3. Place it in your parent directory containing .NET repositories.

## Usage

```bash
./analyze-dotnet.sh
```

### Folder Selection

When launched, the script presents an interactive menu:

```
╔════════════════════════════════════════════════════════════╗
║           .NET Code Analyzer - Folder Selection            ║
╚════════════════════════════════════════════════════════════╝

Current directory: /home/user/projects

Available folders:

  [1] . (Current directory)
  [2] .. (Parent directory)
  [3] MyWebApi
  [4] SharedLibrary
  [5] BackendServices

  [c] Enter custom path
  [q] Quit

Select folder to analyze [1-5, c, or q]:
```

### Sample Output

```
╔══════════════════════════════════════════════════════════════════════════════════════════════╗
║                                    Projects Breakdown                                        ║
╠══════════════════════════════════════════════════════════════════════════════════════════════╣
║ Project                                     Files      NuGet    Non-Empty  Meaningful    Ratio ║
╠══════════════════════════════════════════════════════════════════════════════════════════════╣
║ MyWebApi.Core                                  45         12        3500       2100      60.0% ║
║ MyWebApi.Services                              32          8        2200       1450      65.9% ║
║ MyWebApi.Infrastructure                        28         15        1800       1100      61.1% ║
║ MyWebApi.Tests                                 20          5         900        650      72.2% ║
╚══════════════════════════════════════════════════════════════════════════════════════════════╝

╔════════════════════════════════════════════════════════════╗
║                       Summary Totals                       ║
╠════════════════════════════════════════════════════════════╣
║ Total project files (*.csproj):                          4 ║
║ Total C# source files (*.cs):                          125 ║
║ Total NuGet dependencies:                               40 ║
╠════════════════════════════════════════════════════════════╣
║ Total non-empty lines:                                8400 ║
║ Total meaningful code lines:                          5300 ║
║ Overall code efficiency ratio:                       63.1% ║
╚════════════════════════════════════════════════════════════╝
```

## Requirements

- **Bash 3.x or higher** (compatible with macOS default bash)
- **Standard Unix utilities**: `find`, `grep`, `awk`, `sed`, `wc`, `sort`, `md5sum` (or `md5` on macOS)

## Directory Structure

The script expects to be placed in a parent directory containing one or more .NET repositories:

```
projects/
├── analyze-dotnet.sh
├── Repository1/
│   ├── src/
│   │   ├── Project1/
│   │   │   ├── Project1.csproj
│   │   │   └── *.cs files
│   │   └── Project2/
│   │       ├── Project2.csproj
│   │       └── *.cs files
│   └── tests/
│       └── Project1.Tests/
│           ├── Project1.Tests.csproj
│           └── *.cs files
└── Repository2/
    └── ...
```

## Notes

- Files not associated with any `.csproj` are grouped under "(Files without project)"
- The script uses temporary files for data storage (automatically cleaned up)
- Large codebases may take some time to analyze due to line-by-line parsing
- Only `*.cs` files are analyzed; other file types are ignored

## License

MIT License - Feel free to use and modify as needed.
